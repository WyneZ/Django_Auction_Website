<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boot</title>
    <link rel="stylesheet" type="text/css" href="{% static 'styles/bs/css/bootstrap.min.css' %}">
    <link rel="stylesheet"  href="{% static 'styles/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN">

</head>
<body>
  {% include 'navbar.html' %}
<!-- ----------------/ Navbar -->

  <div class="header row">
    <div class="col px-0">
      <div class="product">
        <img class="thumbnail active_thumbnail" src="{{ images.0.image_url.url }}">
        <img class="thumbnail" src="{% static 'image/bag6.png' %}">
        <img class="thumbnail" src="{% static 'image/bag2.png' %}">
        <img class="thumbnail" src="{% static 'image/bag3.png' %}">
        <img class="thumbnail" src="{% static 'image/bag4.png' %}">
        <img class="thumbnail" src="{% static 'image/bag5.png' %}">
      </div>
    </div>
    <div class="col-6 px-0">
      <h2 class="detail_title container fw-semibold fs-1 mb-5 text-center">{{ item.title }}</h2>
      <img class="imagebox img-fluid" src="{{ images.0.image_url.url }}" id="imagebox" alt="">
      <form method="POST" action="{% url 'like_item' item.id 'detail' %}" class="rateForm shadow rounded-pill  my-3">
        {% csrf_token %}
        {% if user in item.liked_users.all %}
          <button class="rate btn btn-light border-0 rounded-pill">
            <i class="fa-solid fa-heart" style="color: #a80000;"></i>
          </button>
        {% else %}
          <button class="rate btn btn-light border-0 rounded-pill">
            <i class="fa-regular fa-heart" style="color: #333;"></i>
          </button>
        {% endif %}
        <span class="count heart_count ms-1">{{ item.like_count }}</span>
      </form>
      <div class="content mt-5">
        <div class="accordion" id="accordionPanelsStayOpenExample">
          <div class="accordion-item border-0">
            <h5 class="accordion-header">
              <button class="item-description fw-semibold border-0 bg-body-tertiary collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="false" aria-controls="panelsStayOpen-collapseOne">
                Item's Description
                <i class="fa-solid fa-caret-down" style="color: #050505;"></i>
              </button>
            </h5>
            <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
              <div class="accordion-body">
                <p>{{ item.description }}</p>
              </div>
            </div>
          </div>
        </div>
        <!-- items fact -->
        <div class="d-flex">
          <ul class="ulList">
            <li>
              <p class="my-0">CATAGORIES/ TYPE</p>
              <span class="brand fw-semibold">{{ item.category }}</span>
            </li>

            <li>
              <p class="my-0">NO. of ITEM</p>
              <span class="bid_price fw-semibold">{{ item.number_of_items }}</span>
            </li>

            <li>
              <p class="my-0">MODEL/ NAME /ARTIST</p>
              {% if item.item_name == None %}
                <span class="brand fw-semibold">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;---</span>
              {% else %}
                <span class="brand fw-semibold">{{ item.item_name }}</span>
              {% endif %}
          </ul>


          <ul class="ulList">
            <li>
              <p class="my-0">CONDITION</p>
              <span class="condition fw-semibold">{{ item.item_condition }}</span>
            </li>

            <li>
              <p class="my-0">COUNTRY of ORIGIN</p>
              <span class="country fw-semibold">{{ item.country_of_origin }}</span>
            </li>

            <li>
              <p class="my-0">ESTIMATED PERIOD / ERA</p>
              <span class="brand fw-semibold">{{ item.estimated_era }}</span>
          </ul>
        </div>
        <hr>

        <!-- Review -->
        <div class="reviewBox">
          <div>
            <p class="fw-bold">{{ review_count }} reviews</p>
<!--            1st ment-->
            {% for comment in comments %}
              {% if comment.parent_comment == None %}
                <div class="review">
                  <p class="bidderReview m-0">{{ comment.text }}</p>
                  <span class="bidderName me-2" >{{ comment.user.username }}</span>
                  <span class="fw-bold">|</span>
                  <span class="month">{{ comment.created_at|timesince }} ago</span>
                  <a data-bs-toggle="collapse" href="#reply1" aria-expanded="false" aria-controls="collapseExample">
                    Reply
                  </a>
                  <div class="collapse" id="reply1">
                    <form method="POST" action="{% url 'reply_section' comment.id %}">
                      {% csrf_token %}
                      <input type="text" name="reply_text" class="border-0 border-bottom p-2 mb-4" style="width:500px;" placeholder=" reply review">
                      <button type="submit" class="btn btn-dark shadow rounded-end">
                        <i class="fa-solid fa-reply" style="color: #ffffff;"></i>
                      </button>
                    </form>

                  </div>
                </div>
    <!--            End 1st ment-->
    <!--            Reply Section for 1st cmt-->
                <div class="reply_box">
                  <button class="item-description fw-semibold border-0 bg-body-tertiary collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cmt{{ comment.id }}" aria-expanded="false">
                    View Replies
                  </button>
    <!--              Reply comment-->
                  {% for reply in replies %}
                    {% if reply.parent_comment == comment %}
                      <div class="collapse" id="cmt{{ comment.id }}">
                        <div class="reply_cmt">
                          <p class="bidderReview m-0">{{ reply.text }}</p>
                          <span class="bidderName me-2">{{ reply.user.username }}</span>
                          <span class="fw-bold">|</span>
                          <span class="month">{{ reply.created_at|timesince }} ago</span>
                        </div>
                      </div>
                    {% endif %}
                  {% endfor %}
    <!--              End reply comment-->
                </div>
              {% endif %}
            {% endfor %}
<!--           End Reply section for 1st ment-->
          </div>

          <div>
            <form method="POST" action="{% url 'comment_section' item.id %}">
              {% csrf_token %}
              <input type="text" name="comment_text" class="cmtBox p-2 mb-4 rounded-start" placeholder="Write Reviews">
              <button type="submit" class="sentBtn btn btn-dark shadow rounded-end">
                <i class="fa-solid fa-paper-plane" style="color: #ffffff;"></i>
              </button>
            </form>
          </div>
        </div>
        <hr>
      </div>
    </div>

  <!--???BIDFORM SECTION  -->

    <div class="bidForm col-4 px-3 mx-0">

      <div class="card border-black mb-3" style="max-width:25rem;">
        <div class="card-header bg-transparent border-black">

          <img src="{{ item.seller.avatar.url }}"  width="50" height="50" class="my-2 rounded-circle">
          <span class="profileName fs-5 fw-semibold mx-2">{{ item.seller.name }}</span>

        </div>


        <div class="card-body">

          <!-- *CloseIN TIME -->
          <div class="d-flex text-black my-3">
            {% if item.due_date != "expired" %}
              <span class="text me-2 fs-5" id="close_in">Closes in</span>
              <div class="colseIn d-flex me-1">
                <span class="day" id="countdown"></span>
                <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                <script>
                    $(document).ready(function() {
                        // var endDate = "2024-02-11T12:56"
                        var endDate = "{{ item.due_date }}";

                        if (endDate != "expired") {
                            var countdownDate = new Date(endDate).getTime();

                            var x = setInterval(function() {
                                var now = new Date().getTime();
                                var distance = countdownDate - now;

                                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                                document.getElementById("countdown").innerHTML = days + "d " + hours + "h " + minutes + "m " + seconds + "s ";

                                if (distance < 0) {
                                    clearInterval(x);
                                    document.getElementById("countdown").innerHTML = "EXPIRED";
                                }
                            }, 1000);
                        }
                        else {
                            document.getElementById("countdown").innerHTML = "EXPIRED";
                        }

                    });
                </script>
              </div>
            {% else %}
              <span class="text me-2 fs-5" >Bidding Closed</span>
            {% endif %}
          </div>
          <!-- */CloseIN TIME -->

          <!-- ? BID -->
          <div class="bidBox mx-3 my-2">
            {% if item.due_date != "expired" %}
              <p class="my-0">CURRENT BID</p>
              <img src="{% static 'image/coin (3).png' %}"  width="25" height="25" class="coin my-2 mb-4">
              <span class="bid_price fs-2 fw-semibold">{{ item.sell_price }}</span>
            {% else %}
            <p class="my-0">FINAL BID</p>
              {% if item.winner == None %}
                <span class="bid_price fs-2 fw-semibold">No Bidders</span>
              {% else %}
                <img src="{% static 'image/coin (3).png' %}"  width="25" height="25" class="coin my-2 mb-4">
                <span class="bid_price fs-2 fw-semibold">{{ item.sell_price }}</span>
              {% endif %}
            {% endif %}

          </div>

          {% if request.user != item.seller and item.due_date != "expired" %}
            <div class="onceBid d-flex justify-content-around ">
              <button type="button" class="bidBtn btn btn-outline-warning text-black">
                <img src="{% static 'image/coin (3).png' %}"  width="20" height="20" class="coin my-2">
                <span class="">{{ item.sell_price|add:item.once_up }}</span>
              </button>

              <button type="button" class="bidBtn btn btn-outline-warning text-black">
                <img src="{% static 'image/coin (3).png' %}"  width="20" height="20" class="coin my-2">
                <span class="">{{ item.sell_price|add:item.once_up|add:item.once_up }}</span>
              </button>

              <button type="button" class="bidBtn btn btn-outline-warning text-black">
                <img src="{% static 'image/coin (3).png' %}"  width="20" height="20" class="coin my-2">
                <span class="">{{ item.sell_price|add:item.once_up|add:item.once_up|add:item.once_up }}</span>
              </button>
            </div>
            <div class="container mx-2">
              <form method="POST">
                {% csrf_token %}
                <input type="text" class="bidInput rounded-start" name="amount" placeholder="Enter your bid">
                <button class="setBid btn btn-dark rounded-end" type="submit">BID</button>
              </form>
            </div>
          {% endif %}

        </div>
        <!-- ?/BID -->


        <!--// Bidder HISTORY  -->
        <div class="card-footer bg-transparent border-dark">
          <table class="table m-3">
            <tbody>
              {% for bid in bids %}
                <tr>
                  <td class="bidderName">{{ bid.bidder.name }}</td>
                  <td class="bidderHour">
                    <span>{{ bid.created|timesince }}</span> ago</td>
                  <td class="bidCoin">
                    <img src="image/coin (3).png"  width="15" height="15" class="coin my-2">
                    <span class="">{{ bid.amount }}</span>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <!-- ///Bigger History -->
      </div>
    </div>
  <!--???BIDFORM SECTION  -->
  </div>

  <!-- ?Related Post -->
  <div id="related" class="items container">
    <hr>
    <div class="text d-flex justify-content-between">
      <h5 class="text px-3 pb-3 fw-semibold">Related Post</h5>
      <a class="link-secondary link-underline-opacity-0" href="items.html">
        <p class="text px-3 pb-3 te">See More</p>
      </a>
    </div>

<!--    PUT COPY TEXT HERE-->


  </div>
   <!-- -----------Follow us------------- -->
   <div class="termBox container-fluid bg-body-secondary" style="height: 90px;">
    <div class="container">
      <div class="container py-4">
        <div class=" list-unstyled d-flex justify-content-around m-0">
          <h3 class="fw-semibold col-2">Follow Us</h3>
          <i class="followUs fa-brands fa-facebook" style="color: rgb(0, 0, 0);"></i>
          <i class="followUs fa-brands fa-twitter" style="color: #000000;"></i>
          <i class="followUs fa-brands fa-instagram" style="color: #000000;"></i>
          <i class="followUs fa-brands fa-youtube" style="color: #000000;"></i>
          <i class="followUs fa-brands fa-linkedin" style="color: #000000;"></i>
        </div>
    </div>
  </div>
  <!-- ------------Trems------------ -->
    <div class="termBox container d-flex justify-content-between ">
      <ul class="explore_ul list-unstyled ms-5">
        <li class="fw-semibold text-black">About Eagle Auction</li>
        <li><a href="">About Eagle Auction</a></li>
        <li><a href="">Our Experts</a></li>
        <li><a href="">Careers</a></li>
      </ul>

      <ul class="explore_ul  list-unstyled">
        <li class="fw-semibold text-black">Buy</a></li>
        <li><a href="">How to Buy</a></li>
        <li><a href="">Buyer Protection</a></li>
        <li><a href="">Buyer terms</a></li>
      </ul>

      <ul class="explore_ul  list-unstyled">
        <li class="fw-semibold text-black">Sell</a></li>
        <li><a href="">How to Sell</a></li>
        <li><a href="">Seller Tips</a></li>
        <li><a href="">Seller terms</a></li>
      </ul>

      <ul class="explore_ul  list-unstyled">
        <li class="fw-semibold text-black">My Eagle</a></li>
        <li><a href="">Sign in</a></li>
        <li><a href="">Register</a></li>
        <li><a href="">Help Centre</a></li>
      </ul>

      <hr>
    </div>
   </div>

    <script>

        let thumbnails = document.getElementsByClassName('thumbnail')

        let activeImages = document.getElementsByClassName('active_thumbnail')

        for (var i=0; i < thumbnails.length; i++){

          thumbnails[i].addEventListener('click', function(){
            console.log(activeImages)

            if (activeImages.length > 0){
              activeImages[0].classList.remove('active_thumbnail')
            }


            this.classList.add('active_thumbnail')
            document.getElementById('imagebox').src = this.src
          })
        }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>